function outputRoomName(room){document.getElementById("room-name").innerText=room}function outputUsers(users){$("#users").html(""),users.forEach(user=>{"Nick"!=user.username&&$("#users").append($('<li id="'+user.id+'" style="cursor:pointer" title="'+user.id+'">').text(user.username).hide().fadeIn())})}function outputMessage(message){let class_message="";"ChatBot"==message.username?class_message="operator avatarChatClient":"Nick"==message.username&&(class_message="operator avatarOperator"),$(".chat-messages-container").append($('<div class="bubble '+class_message+'"><p class="meta">'+message.username+"<span> "+message.time+'</span></p><p class="text">'+message.text+"</p></div>").hide().fadeIn())}$((function(){const socket=io.connect("https://www.host-x.de:3000");socket.on("userJoin",(function(msg){null!==window.localStorage.getItem("usr")&&null!==window.localStorage.getItem("room")&&socket.emit("send-user-and-room-name",{username:window.localStorage.getItem("usr"),room:window.localStorage.getItem("room")})})),socket.on("roomUsers",({room:room,users:users})=>{outputRoomName(room),outputUsers(users)}),socket.on("message",message=>{outputMessage(message);var obj=document.createElement("audio");obj.src="./assets/audio/beep.mp3",obj.play();const chatContainer=document.querySelector(".chat-messages-container");chatContainer&&(chatContainer.scrollTop=chatContainer.scrollHeight);const chatContainerOperator=document.querySelector(".chat-messages-operator-container");chatContainerOperator&&(chatContainerOperator.scrollTop=chatContainerOperator.scrollHeight)}),$("#bwChatSystemClient, #bwChatSystemOperator").on("keydown",(function(e){if("Enter"===e.key){e.preventDefault();let ReceiversSocketId=$("#ReceiversSocketId").val(),path,page=window.location.pathname.split("/").pop();if("chatclient.html"==page&&(ReceiversSocketId=""),""==ReceiversSocketId&&"operator.html"==page)return void alert("Please choose a user");if(""==$("#msgOperator").val())return void("operator.html"==page&&alert("Message can not be empty"));if(""==$("#msg").val())return;"operator.html"==page?(socket.emit("ChatMessageOneToOne",{msg:$("#msgOperator").val(),ReceiversSocketId:ReceiversSocketId}),$("#msgOperator").val(""),$("#msgOperator").attr("placeholder","")):(socket.emit("ChatMessageOneToOne",{msg:$("#msg").val(),ReceiversSocketId:ReceiversSocketId}),$("#msg").val(""),$("#msg").attr("placeholder",""))}})),null===window.localStorage.getItem("usr")&&($("#bwChatSystemClient").fadeOut(),$("#OperatorContainer").fadeOut(),$(".chat-messages-container").fadeOut(),$("#logincontainer").fadeIn()),$("#logincontainer").submit((function(e){e.preventDefault();let usr=$("#usr").val(),room=$("#room").val();window.localStorage.setItem("usr",usr),window.localStorage.setItem("room",room),$("#logincontainer").fadeOut(),$("#OperatorContainer").fadeIn(),$("#bwChatSystemClient").fadeIn(),$(".chat-messages-container").fadeIn(),location.reload(),document.getElementById("msg").focus()}))}));